<!DOCTYPE html>
<html xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout" xmlns:th="http://www.thymeleaf.org"
	layout:decorate="~{fragments/layout}">

<head>
	<div th:replace="fragments/layout.html :: html_head" />
	<link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/smoothness/jquery-ui.css">
	<script src="//code.jquery.com/jquery-1.12.4.js"></script>
	<script src="//code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
	<script type="text/javascript" src="../plugins/chart.js/chart.utils.js"></script>
</head>

<body class="hold-transition sidebar-mini">
	<div class="wrapper">
		<div th:replace="fragments/layout.html :: nav_menu" />
		<div th:replace="fragments/layout.html :: sidebar" />

		<div class="content-wrapper">
			<!-- Content Header (Page header) -->
			<div class="content-header">
				<div class="container-fluid">
					<div class="row mb-2">
						<div class="col-sm-6">
							<h1 class="m-0">Dashboard</h1>
						</div><!-- /.col -->
						<div class="col-sm-6">
							<ol class="breadcrumb float-sm-right">
								<li class="breadcrumb-item"><a href="#">Home</a></li>
								<li class="breadcrumb-item active">Dashboard</li>
							</ol>
						</div>
					</div><!-- /.row -->
				</div><!-- /.container-fluid -->
			</div>
			<!-- /.content-header -->

			<!-- Main content -->
			<div class="content">
				<div class="container-fluid">
					<div class="row">
						<div class="col-lg-6">
							<div class="card">
								<div class="card-header">
									<h3 class="card-title">Job Postings Status</h3>
									<div class="card-tools">
										<!-- Buttons, labels, and many other things can be placed here! -->
									</div>
									<!-- /.card-tools -->
								</div>
								<!-- /.card-header -->
								<div class="card-body">
									<canvas id="job-status-pie"></canvas>
								</div>
								<!-- /.card-body -->
							</div>
							<!-- /.card -->
						</div>
						<!-- /.col -->

						<div th:if="${recentActivities.size() > 0}" class="col-lg-6">
							<div class="card">
								<div class="card-header">
									<h3 class="card-title">Recent Activities</h3>
								</div>
								<!-- /.card-header -->
								<div class="card-body">
									<!-- Main node for this component -->
									<div class="timeline">
										<!-- Timeline time label -->
										<div th:each="row : ${recentActivities}" th:remove="tag">
											<div class="time-label">
												<span class="bg-info btn-xs" th:text="${row.key}"></span>
											</div>
											<div th:each="v : ${row.value}">
												<i class="fas fa-envelope bg-blue"></i>
												<i th:if="${v.category.name == 'CREATED'}"
													class="fas fa-plus bg-lightblue"></i>
												<i th:if="${v.category.name == 'DELETION'}"
													class="fas fa-trash bg-lightblue"></i>
												<i th:if="${v.category.name == 'PENDING'}"
													class="fas fa-exclamation bg-lightblue"></i>
												<i th:if="${v.category.name == 'ACCEPTION'}"
													class="fas fa-user-doctor bg-lightblue"></i>
												<i th:if="${v.category.name == 'CANCELLATION'}"
													class="fas fa-xmark bg-gray"></i>
												<i th:if="${v.category.name == 'REMOVED'}"
													class="fas fa-ban bg-danger"></i>
												<i th:if="${v.category.name == 'COMPLETED_JOB'}"
													class="fas fa-check bg-lightblue"></i>
												<i th:if="${v.category.name == 'PROCESSED_PAYMENT'}"
													class="fas fa-dollar bg-lightblue"></i>
												<!-- Timeline item -->
												<div class="timeline-item">
													<!-- Time -->
													<span class="time"><i class="fas fa-clock"></i> <span
															th:text="${v.getTimeOnlyString}"></span></span>
													<!-- Header. -->
													<h2 class="timeline-header" style="font-weight: bold;"><span
															th:text="${v.category.value}"></span>
														<a th:unless="${v.category.name == 'REMOVED' OR v.category.name == 'DELETED'}"
															th:href="@{/jobpost/}+${v.jobPost.id}"
															th:text="${' #' + v.jobPost.id + ': ' + v.jobPost.title}"></a>
														<span
															th:if="${v.category.name == 'REMOVED' OR v.category.name == 'DELETED'}"
															th:text="${' (Job Post Id #' + v.jobPost.id} + ')'"></span>
													</h2>
												</div>
											</div>
										</div>
										<div>
											<i class="fas fa-clock bg-gray"></i>
											<div style="margin-left:60px;">
												<a th:href="@{/jobpost/list}">View more</a>
											</div>
										</div>
									</div>
								</div><!-- /.card-body -->
							</div><!-- /.card -->
						</div>
						<!-- /.col -->
					</div>
				</div><!-- /.container-fluid -->
			</div>
			<!-- /.content -->
		</div>
		<div th:replace="fragments/layout.html :: footer" />
		<div th:replace="fragments/layout.html :: script" />
	</div>
	<script src="../plugins/chart.js/Chart.min.js"></script>
	<script th:inline="javascript">
		/*<![CDATA[*/
		/* JOBS STATUS - PIE CHART */
		const ctx = document.getElementById('job-status-pie');
		var jobStatusList = /*[[${jobStatusList}]]*/ {};
		var jobStatusData = /*[[${jobStatusData}]]*/ {};
		var pieOptions = {
			legend: {
				position: 'right',
				labels: {
					usePointStyle: true,
					pointStyle: 'circle',
					padding: 15
				}
			}
		};
		const jobStatusChart = new Chart(ctx, {
			type: 'pie',
			data: {
				labels: jobStatusList,
				datasets: [{
					data: jobStatusData,
					backgroundColor: COLORS,
					hoverOffset: 4
				}]
			},
			options: pieOptions
		});
		/*]]>*/
	</script>
</body>

</html>